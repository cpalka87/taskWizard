<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="assets/css/all.css">
    <link rel="stylesheet" href="assets/bootstrap.min.css">
    <link rel="stylesheet" href="assets/stylesheet.css">
    <script src="assets/lib.js"></script>
    <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
  </head>
<body>
 <script>
  function variantBuilder() {
    var productUrl = document.getElementById('site-url').value;
    var siteName = productUrl.split('.');
    siteName = siteName[0].slice(8);
    siteName = siteName.charAt(0).toUpperCase() + siteName.slice(1);
    productUrl = productUrl.split('/');
    var length = [];
    var domain = productUrl[2]
    var handle = productUrl[productUrl.length - 1];
    if (domain !== undefined) {

      $.getJSON(`https://${domain}/products.json`, function( data ) {  
        var regex = new RegExp(`\\b(\\w*${handle}\\w*)\\b`)
        var items = [];
        var size = [];
        for (var product in data) {
          var currentProduct = data[product];
          for (var i = 0; i < currentProduct.length; i++) {
            for (var j = 0; j < currentProduct[i].variants.length; j++)
            if (currentProduct[i].handle.match(regex)) {
              
              items.push(currentProduct[i].variants[j].id)
              size.push(currentProduct[i].variants[j].title)
              length.push(currentProduct[0].variants[0].id.toString().length)
            }
          }
          
        }
        $('#variants-box').text(items.join('\n'))
        $('#size').text(size.join('\n'))
        objCleaner(length[0], siteName)
      });
    }
  }
  
  </script>

    <h1 id ="title">DonkWizard</h1>

    <div class="container">
          <h2>VariantBuilder</h2>
        <form>
          <div class="form-group">
            <div class="row">
              <div class="col">
                <label for="site-url">Insert product URL</label>
                <textarea class="form-control" id="site-url" rows="1" placeholder="Paste product URL here"></textarea>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col button-url-submit">
              <button type="button" id="button-url-submit" class="btn-lg btn-primary" value="Submit" onclick="validateSiteURL()">Build</button>
            </div>
            <div class="col button-copy">
              <button type="button" id="button-save" class="btn-lg btn-primary" onclick="validateOutput()">Download</button>
            </div>
          </div>
        </div>
        <div class="container">
          <div class="form-row">
            <div class="col">
              <label for="variants">Variants:</label>
              <span class="copy-icon" onclick="clipBoard('variants-box')">
                <i class="far fa-clipboard"></i>
              </span> 
              <textarea class ="form-control" id="variants-box" rows="25" cols="10"></textarea>
            </div>
            <div class="col">
              <label for="size">Size:</label>
              <span class="copy-icon" onclick="clipBoard('size')">
                <i class="far fa-clipboard"></i>
              </span> 
              <textarea class ="form-control" id="size" rows="25" cols="10"></textarea> 
            </div>
            <div class="col">
              <label for="output">Output:</label>
              <span class="copy-icon" onclick="clipBoard('output')">
                <i class="far fa-clipboard"></i>
              </span> 
              <textarea class="form-control" id="output" rows="25" cols="75" placeholder="Copy output and paste generated output into your .json file or download directly"></textarea> 
            </div>
          </div>
        </form>
      </div>
    <script>$('#variants-box').attr('placeholder', 'Please format variants and site name below if building task' + '\n' + '\n' + '12345678912345' + '\n'+ '12345678912345' + '\n'+ '12345678912345' + '\n' + 'Undefeated');</script>

  </body>
</html>
